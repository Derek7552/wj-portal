# å‰ç«¯ç»„ä»¶åº“å¼•ç”¨æŒ‡å—

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•åœ¨æ–°é¡¹ç›®ä¸­å¼•ç”¨å‰ç«¯ä»£ç ç»„ä»¶åº“ã€‚

---

## ğŸ“¦ ç»„ä»¶åº“ç±»å‹ä¸å¼•ç”¨æ–¹å¼

### 1. **æœ¬åœ°æ–‡ä»¶ç»„ä»¶åº“**ï¼ˆå½“å‰é¡¹ç›®ä½¿ç”¨çš„æ–¹å¼ï¼‰

å¦‚æœä½ çš„ç»„ä»¶åº“æ˜¯æœ¬åœ°æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¯ä»¥é€šè¿‡ç›¸å¯¹è·¯å¾„å¼•ç”¨ã€‚

#### ç›®å½•ç»“æ„ç¤ºä¾‹
```
your-project/
â”œâ”€â”€ components/          # ç»„ä»¶åº“ç›®å½•
â”‚   â”œâ”€â”€ chat-input/
â”‚   â”‚   â”œâ”€â”€ chat-input.html
â”‚   â”‚   â”œâ”€â”€ chat-input.css
â”‚   â”‚   â””â”€â”€ chat-input.js
â”‚   â””â”€â”€ button/
â”‚       â”œâ”€â”€ button.html
â”‚       â”œâ”€â”€ button.css
â”‚       â””â”€â”€ button.js
â””â”€â”€ pages/
    â””â”€â”€ index.html       # ä½¿ç”¨ç»„ä»¶çš„é¡µé¢
```

#### å¼•ç”¨æ–¹å¼

**åœ¨ HTML ä¸­å¼•ç”¨ï¼š**

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æˆ‘çš„é¡¹ç›®</title>
    
    <!-- å¼•ç”¨ç»„ä»¶ CSS -->
    <link rel="stylesheet" href="../components/chat-input/chat-input.css">
    <link rel="stylesheet" href="../components/button/button.css">
    
    <!-- å¼•ç”¨å…¨å±€æ ·å¼ï¼ˆå¦‚æœæœ‰ï¼‰ -->
    <link rel="stylesheet" href="../css/common.css">
</head>
<body>
    <!-- å¼•å…¥ç»„ä»¶ HTML -->
    <div id="chat-input-container"></div>
    
    <!-- å¼•ç”¨ç»„ä»¶ JS -->
    <script src="../components/chat-input/chat-input.js"></script>
    <script src="../components/button/button.js"></script>
    
    <!-- åˆå§‹åŒ–ç»„ä»¶ -->
    <script>
        // åˆå§‹åŒ–èŠå¤©è¾“å…¥æ¡†
        initChatInput();
    </script>
</body>
</html>
```

**ä½¿ç”¨ JavaScript åŠ¨æ€åŠ è½½ç»„ä»¶ï¼š**

```javascript
// åŠ¨æ€åŠ è½½ç»„ä»¶ HTML
async function loadComponent(componentName) {
    const response = await fetch(`../components/${componentName}/${componentName}.html`);
    const html = await response.text();
    return html;
}

// ä½¿ç”¨ç¤ºä¾‹
async function initPage() {
    const chatInputHTML = await loadComponent('chat-input');
    document.getElementById('chat-input-container').innerHTML = chatInputHTML;
    
    // åŠ è½½ç»„ä»¶ JS
    const script = document.createElement('script');
    script.src = '../components/chat-input/chat-input.js';
    document.body.appendChild(script);
    
    // ç­‰å¾…è„šæœ¬åŠ è½½ååˆå§‹åŒ–
    script.onload = () => {
        initChatInput();
    };
}
```

---

### 2. **NPM åŒ…ç»„ä»¶åº“**

å¦‚æœç»„ä»¶åº“å·²å‘å¸ƒä¸º npm åŒ…ï¼Œå¯ä»¥é€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…ã€‚

#### å®‰è£…ç»„ä»¶åº“

```bash
# ä½¿ç”¨ npm
npm install your-component-library

# ä½¿ç”¨ yarn
yarn add your-component-library

# ä½¿ç”¨ pnpm
pnpm add your-component-library
```

#### å¼•ç”¨æ–¹å¼

**ES6 æ¨¡å—æ–¹å¼ï¼ˆæ¨èï¼‰ï¼š**

```javascript
// åœ¨ JavaScript æ–‡ä»¶ä¸­
import { ChatInput, Button } from 'your-component-library';
import 'your-component-library/dist/styles.css';

// ä½¿ç”¨ç»„ä»¶
const chatInput = new ChatInput({
    container: '#chat-input-container',
    placeholder: 'è¾“å…¥æ‚¨çš„é—®é¢˜...'
});
```

**CommonJS æ–¹å¼ï¼š**

```javascript
const { ChatInput, Button } = require('your-component-library');
require('your-component-library/dist/styles.css');
```

**åœ¨ HTML ä¸­ç›´æ¥å¼•ç”¨ï¼ˆå¦‚æœç»„ä»¶åº“æä¾›äº† UMD ç‰ˆæœ¬ï¼‰ï¼š**

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æˆ‘çš„é¡¹ç›®</title>
    
    <!-- å¼•ç”¨ç»„ä»¶åº“ CSS -->
    <link rel="stylesheet" href="./node_modules/your-component-library/dist/styles.css">
</head>
<body>
    <div id="chat-input-container"></div>
    
    <!-- å¼•ç”¨ç»„ä»¶åº“ JS -->
    <script src="./node_modules/your-component-library/dist/index.umd.js"></script>
    
    <script>
        // ä½¿ç”¨ç»„ä»¶
        const chatInput = new YourComponentLibrary.ChatInput({
            container: '#chat-input-container'
        });
    </script>
</body>
</html>
```

---

### 3. **Git ä»“åº“ç»„ä»¶åº“**

å¦‚æœç»„ä»¶åº“åœ¨ Git ä»“åº“ä¸­ï¼Œå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼å¼•ç”¨ã€‚

#### æ–¹å¼ 1ï¼šGit å­æ¨¡å—ï¼ˆSubmoduleï¼‰

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ·»åŠ å­æ¨¡å—
git submodule add https://github.com/your-org/component-library.git components

# åˆå§‹åŒ–å­æ¨¡å—
git submodule init
git submodule update

# æˆ–ä¸€æ¬¡æ€§å®Œæˆ
git submodule update --init --recursive
```

**å¼•ç”¨æ–¹å¼ï¼š**

```html
<!-- å¼•ç”¨å­æ¨¡å—ä¸­çš„ç»„ä»¶ -->
<link rel="stylesheet" href="./components/dist/styles.css">
<script src="./components/dist/index.js"></script>
```

#### æ–¹å¼ 2ï¼šnpm å®‰è£… Git ä»“åº“

```bash
# å®‰è£… Git ä»“åº“ä½œä¸ºä¾èµ–
npm install git+https://github.com/your-org/component-library.git

# æˆ–æŒ‡å®šåˆ†æ”¯/æ ‡ç­¾
npm install git+https://github.com/your-org/component-library.git#main
npm install git+https://github.com/your-org/component-library.git#v1.0.0
```

ç„¶åæŒ‰ç…§ npm åŒ…çš„æ–¹å¼å¼•ç”¨ã€‚

#### æ–¹å¼ 3ï¼šç›´æ¥å…‹éš†åˆ°é¡¹ç›®

```bash
# å…‹éš†ç»„ä»¶åº“åˆ°é¡¹ç›®ç›®å½•
git clone https://github.com/your-org/component-library.git components
```

ç„¶åæŒ‰ç…§æœ¬åœ°æ–‡ä»¶çš„æ–¹å¼å¼•ç”¨ã€‚

---

### 4. **CDN å¼•ç”¨**

å¦‚æœç»„ä»¶åº“æä¾›äº† CDN ç‰ˆæœ¬ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ `<script>` å’Œ `<link>` æ ‡ç­¾å¼•ç”¨ã€‚

```html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>æˆ‘çš„é¡¹ç›®</title>
    
    <!-- å¼•ç”¨ç»„ä»¶åº“ CSS -->
    <link rel="stylesheet" href="https://cdn.example.com/component-library/latest/styles.css">
</head>
<body>
    <div id="chat-input-container"></div>
    
    <!-- å¼•ç”¨ç»„ä»¶åº“ JS -->
    <script src="https://cdn.example.com/component-library/latest/index.js"></script>
    
    <script>
        // ä½¿ç”¨ç»„ä»¶
        const chatInput = new ComponentLibrary.ChatInput({
            container: '#chat-input-container'
        });
    </script>
</body>
</html>
```

---

## ğŸ¯ å®é™…é¡¹ç›®ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šå¼•ç”¨å½“å‰é¡¹ç›®çš„ç»„ä»¶åº“

å‡è®¾ä½ æœ‰ä¸€ä¸ªæ–°é¡¹ç›®ï¼Œæƒ³è¦å¼•ç”¨ `wj_portal` é¡¹ç›®ä¸­çš„ç»„ä»¶åº“ï¼š

#### æ–¹å¼ Aï¼šå¤åˆ¶ç»„ä»¶æ–‡ä»¶

```bash
# åœ¨æ–°é¡¹ç›®ä¸­åˆ›å»ºç»„ä»¶ç›®å½•
mkdir -p components

# å¤åˆ¶ç»„ä»¶æ–‡ä»¶
cp -r /path/to/wj_portal/frontend/components/* ./components/
```

ç„¶ååœ¨ HTML ä¸­å¼•ç”¨ï¼š

```html
<link rel="stylesheet" href="./components/chat-input/chat-input.css">
<script src="./components/chat-input/chat-input.js"></script>
```

#### æ–¹å¼ Bï¼šä½¿ç”¨ç¬¦å·é“¾æ¥ï¼ˆå¼€å‘ç¯å¢ƒï¼‰

```bash
# åœ¨æ–°é¡¹ç›®ä¸­åˆ›å»ºç¬¦å·é“¾æ¥
ln -s /path/to/wj_portal/frontend/components ./components
```

#### æ–¹å¼ Cï¼šä½¿ç”¨ Git å­æ¨¡å—

```bash
# åœ¨æ–°é¡¹ç›®ä¸­æ·»åŠ å­æ¨¡å—
git submodule add /path/to/wj_portal.git components
```

---

### ç¤ºä¾‹ 2ï¼šä½¿ç”¨æ„å»ºå·¥å…·ï¼ˆWebpack/Viteï¼‰

å¦‚æœä½¿ç”¨ç°ä»£æ„å»ºå·¥å…·ï¼Œå¯ä»¥é…ç½®è·¯å¾„åˆ«åï¼š

**webpack.config.jsï¼š**

```javascript
const path = require('path');

module.exports = {
    resolve: {
        alias: {
            '@components': path.resolve(__dirname, '../wj_portal/frontend/components'),
            '@css': path.resolve(__dirname, '../wj_portal/frontend/css'),
        }
    },
    module: {
        rules: [
            {
                test: /\.css$/,
                use: ['style-loader', 'css-loader']
            }
        ]
    }
};
```

**åœ¨ä»£ç ä¸­ä½¿ç”¨ï¼š**

```javascript
import '@components/chat-input/chat-input.css';
import { initChatInput } from '@components/chat-input/chat-input.js';
```

**vite.config.jsï¼š**

```javascript
import { defineConfig } from 'vite';
import path from 'path';

export default defineConfig({
    resolve: {
        alias: {
            '@components': path.resolve(__dirname, '../wj_portal/frontend/components'),
            '@css': path.resolve(__dirname, '../wj_portal/frontend/css'),
        }
    }
});
```

---

## ğŸ“‹ æœ€ä½³å®è·µ

### 1. **è·¯å¾„ç®¡ç†**

- ä½¿ç”¨ç›¸å¯¹è·¯å¾„æ—¶ï¼Œæ³¨æ„æ–‡ä»¶å±‚çº§å…³ç³»
- è€ƒè™‘ä½¿ç”¨è·¯å¾„åˆ«åï¼ˆå¦‚ `@components`ï¼‰ç®€åŒ–å¼•ç”¨
- ç»Ÿä¸€ç»„ä»¶åº“çš„ç›®å½•ç»“æ„

### 2. **ç‰ˆæœ¬ç®¡ç†**

- å¦‚æœä½¿ç”¨ npm åŒ…ï¼Œé”å®šç‰ˆæœ¬å·ï¼ˆä½¿ç”¨ `package-lock.json` æˆ– `yarn.lock`ï¼‰
- å¦‚æœä½¿ç”¨ Git å­æ¨¡å—ï¼ŒæŒ‡å®šå…·ä½“çš„ commit æˆ– tag
- è®°å½•ç»„ä»¶åº“çš„ç‰ˆæœ¬ä¿¡æ¯

### 3. **ä¾èµ–ç®¡ç†**

```json
{
  "dependencies": {
    "your-component-library": "^1.0.0"
  },
  "devDependencies": {
    "your-component-library": "file:../path/to/component-library"
  }
}
```

### 4. **æ ·å¼éš”ç¦»**

- ä½¿ç”¨ CSS æ¨¡å—åŒ–æˆ–ä½œç”¨åŸŸæ ·å¼
- é¿å…å…¨å±€æ ·å¼æ±¡æŸ“
- ä½¿ç”¨ CSS å˜é‡ç»Ÿä¸€ä¸»é¢˜

### 5. **ç»„ä»¶åˆå§‹åŒ–**

```javascript
// ç»Ÿä¸€çš„ç»„ä»¶åˆå§‹åŒ–å‡½æ•°
function initComponents() {
    // æ£€æŸ¥ä¾èµ–
    if (typeof initChatInput === 'function') {
        initChatInput();
    } else {
        console.error('ChatInput component not loaded');
    }
}

// DOM åŠ è½½å®Œæˆååˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', initComponents);
```

---

## ğŸ”§ å¸¸è§é—®é¢˜

### Q1: è·¯å¾„å¼•ç”¨é”™è¯¯æ€ä¹ˆåŠï¼Ÿ

**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
- ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹ç½‘ç»œè¯·æ±‚
- ä½¿ç”¨ç»å¯¹è·¯å¾„æˆ–é…ç½®è·¯å¾„åˆ«å

### Q2: æ ·å¼å†²çªæ€ä¹ˆåŠï¼Ÿ

**è§£å†³æ–¹æ¡ˆï¼š**
- ä½¿ç”¨ CSS å‘½åç©ºé—´
- ä½¿ç”¨ CSS æ¨¡å—åŒ–
- æ£€æŸ¥æ ·å¼åŠ è½½é¡ºåº

### Q3: ç»„ä»¶åº“æ›´æ–°åå¦‚ä½•åŒæ­¥ï¼Ÿ

**è§£å†³æ–¹æ¡ˆï¼š**
- npm åŒ…ï¼š`npm update your-component-library`
- Git å­æ¨¡å—ï¼š`git submodule update --remote`
- æœ¬åœ°æ–‡ä»¶ï¼šé‡æ–°å¤åˆ¶æˆ–ä½¿ç”¨ç¬¦å·é“¾æ¥

---

## ğŸ“š ç›¸å…³èµ„æº

- [npm æ–‡æ¡£](https://docs.npmjs.com/)
- [Git å­æ¨¡å—æ–‡æ¡£](https://git-scm.com/book/en/v2/Git-Tools-Submodules)
- [Webpack é…ç½®](https://webpack.js.org/configuration/)
- [Vite é…ç½®](https://vitejs.dev/config/)

---

**æœ€åæ›´æ–°**ï¼š2024-12-11

