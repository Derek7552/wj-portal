<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SecCortex 密码找回 - 通过注册邮箱重置您的密码">
    <title>忘记密码 - SecCortex</title>
    <link rel="stylesheet" href="../../css/common.css">
    <link rel="stylesheet" href="../css/auth.css">
    <link rel="stylesheet" href="../css/password-recovery.css">
</head>
<body>
    <!-- 全局导航 -->
    <header class="header">
        <nav class="nav-container">
            <div class="nav-brand">
                <a href="index.html" style="text-decoration: none; display: flex; align-items: center; gap: 12px;">
                    <h1 class="brand-logo">云脑</h1>
                    <span class="brand-slogan">最懂安全的AI智能体平台</span>
                </a>
            </div>
            <ul class="nav-menu" id="navMenu">
                <li class="nav-item"><a href="index.html">云脑</a></li>
                <li class="nav-item"><a href="news.html">资讯</a></li>
                <li class="nav-item"><a href="papers.html">论文</a></li>
                <li class="nav-item"><a href="resources.html">资源</a></li>
            </ul>
            <div class="nav-actions">
                <a href="login.html" class="btn btn-outline">登录</a>
                <a href="register.html" class="btn btn-primary">注册</a>
            </div>
            <button class="mobile-menu-toggle" id="mobileMenuToggle" aria-label="菜单">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </nav>
    </header>

    <!-- 主内容区 -->
    <main class="auth-main">
        <div class="auth-container">
            <!-- 视图1: 邮箱输入表单 -->
            <div class="auth-card" id="emailInputView">
                <div class="auth-header">
                    <h1 class="auth-title">找回密码</h1>
                    <p class="auth-subtitle">请输入您的注册邮箱，我们将向您发送密码重置链接</p>
                </div>

                <form class="auth-form" id="forgotPasswordForm">
                    <div class="form-group">
                        <label for="email" class="form-label">邮箱地址</label>
                        <input
                            type="email"
                            id="email"
                            name="email"
                            class="form-input"
                            placeholder="请输入注册邮箱"
                            required
                        >
                        <div class="form-error" id="emailError"></div>
                    </div>

                    <button type="submit" class="btn btn-primary btn-block" id="sendEmailBtn">
                        <span class="btn-text">发送重置链接</span>
                        <span class="btn-loading" style="display: none;">
                            <span class="loading-spinner"></span>
                            发送中...
                        </span>
                    </button>
                </form>

                <div class="auth-footer" style="border-top: none;">
                    <a href="login.html" class="auth-link">返回登录</a>
                </div>
            </div>

            <!-- 视图2: 发送成功提示 -->
            <div class="auth-card" id="emailSentView" style="display: none;">
                <div class="status-icon status-icon-success">
                    <svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="32" cy="32" r="28" fill="var(--clouditera-palette-blue-0)"/>
                        <path d="M32 16V32L40 40" stroke="var(--clouditera-brand-primary)" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                        <rect x="20" y="28" width="24" height="16" rx="2" stroke="var(--clouditera-brand-primary)" stroke-width="2"/>
                        <path d="M20 32L32 38L44 32" stroke="var(--clouditera-brand-primary)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>

                <div class="auth-header">
                    <h1 class="auth-title">邮件已发送</h1>
                    <p class="auth-subtitle">
                        我们已向 <strong id="maskedEmail"></strong> 发送了密码重置链接，请查收邮件
                    </p>
                </div>

                <div class="info-box info-box-warning">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M10 6V10M10 14H10.01M19 10C19 14.9706 14.9706 19 10 19C5.02944 19 1 14.9706 1 10C1 5.02944 5.02944 1 10 1C14.9706 1 19 5.02944 19 10Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <div>
                        <strong>链接有效期为 1 小时</strong>
                        <p>请尽快完成密码重置操作</p>
                    </div>
                </div>

                <button type="button" class="btn btn-primary btn-block" onclick="window.location.href='login.html'">
                    返回登录
                </button>

                <div class="auth-footer" style="border-top: none; padding-top: 16px;">
                    <span style="color: var(--clouditera-neutral-text-secondary);">没收到邮件？</span>
                    <button type="button" class="resend-link" id="resendBtn">
                        重新发送 <span id="resendCountdown"></span>
                    </button>
                </div>
            </div>

            <!-- 视图3: 链接失效/错误提示 -->
            <div class="auth-card" id="errorView" style="display: none;">
                <div class="status-icon status-icon-error">
                    <svg width="64" height="64" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="32" cy="32" r="28" fill="var(--clouditera-palette-red-0)"/>
                        <path d="M32 20V34M32 42H32.02" stroke="var(--clouditera-semantic-error)" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>

                <div class="auth-header">
                    <h1 class="auth-title" id="errorTitle">链接已失效</h1>
                    <p class="auth-subtitle" id="errorMessage">
                        该密码重置链接已过期或无效，请重新申请
                    </p>
                </div>

                <button type="button" class="btn btn-primary btn-block" id="retryBtn">
                    重新找回密码
                </button>

                <div class="auth-footer" style="border-top: none;">
                    <a href="login.html" class="auth-link">返回登录</a>
                </div>
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <p class="footer-company">云起白山AI安全联合实验室</p>
                <p class="footer-copyright">&copy; 2025 SecCortex 云脑安全智能体平台. All rights reserved.</p>
                <p class="footer-icp">ICP备案号：京ICP备2022020425号</p>
            </div>
        </div>
    </footer>

    <script src="../../js/common.js"></script>
    <script src="../js/password-recovery.js"></script>
</body>
</html>
