# SecCortex 用户密码找回功能 - UI设计说明

> **关联需求**: [PDT-526](https://linear.app/clouditera2025/issue/PDT-526/seccortex-用户密码找回功能)  
> **创建时间**: 2025-12-23  
> **负责人**: liuxin@clouditera.com  
> **项目**: SecCortex（云脑安全智能体平台）

---

## 1. 需求背景

用户在忘记登录密码时，需要通过注册邮箱自助找回密码，无需联系管理员，提升用户体验和系统自助服务能力。

### 用户场景

| 场景 | 描述 |
|------|------|
| 场景一 | 用户长时间未登录系统，忘记了登录密码 |
| 场景二 | 用户首次登录后修改了初始密码，但忘记了新密码 |
| 场景三 | 用户需要在新设备上登录，但记不清密码 |

---

## 2. 页面设计

### 2.1 登录页面 - 忘记密码入口

**位置**: 登录表单下方

**设计要求**:
- 在「登录」按钮下方添加「忘记密码？」文字链接
- 链接样式：使用次要文字颜色，hover 时显示下划线
- 位置居中或右对齐（与设计系统保持一致）

```
┌─────────────────────────────────┐
│         SecCortex 登录          │
├─────────────────────────────────┤
│  邮箱地址                        │
│  ┌─────────────────────────────┐│
│  │ user@example.com            ││
│  └─────────────────────────────┘│
│                                 │
│  密码                           │
│  ┌─────────────────────────────┐│
│  │ ••••••••                    ││
│  └─────────────────────────────┘│
│                                 │
│  ┌─────────────────────────────┐│
│  │          登 录              ││
│  └─────────────────────────────┘│
│                                 │
│           忘记密码？ ←────────── │
│                                 │
└─────────────────────────────────┘
```

---

### 2.2 忘记密码 - 邮箱验证页面

**路由**: `/forgot-password`

**页面结构**:

```
┌─────────────────────────────────┐
│         找回密码                │
├─────────────────────────────────┤
│                                 │
│  请输入您的注册邮箱，我们将向您  │
│  发送密码重置链接。              │
│                                 │
│  邮箱地址                        │
│  ┌─────────────────────────────┐│
│  │ 请输入注册邮箱               ││
│  └─────────────────────────────┘│
│                                 │
│  ┌─────────────────────────────┐│
│  │       发送重置链接           ││
│  └─────────────────────────────┘│
│                                 │
│          返回登录               │
│                                 │
└─────────────────────────────────┘
```

**交互说明**:

| 状态 | 说明 |
|------|------|
| 默认状态 | 显示邮箱输入框和发送按钮 |
| 输入验证 | 实时验证邮箱格式，格式错误时显示红色边框和提示 |
| 发送中 | 按钮显示 loading 状态，禁用重复点击 |
| 发送成功 | 显示成功提示页面，告知用户查收邮件 |
| 发送失败 | 显示错误提示（邮箱未注册 / 请求过于频繁） |

**频率限制提示**:
- 60秒内重复请求时显示：「请求过于频繁，请 XX 秒后重试」
- 显示倒计时，倒计时结束后恢复按钮可点击状态

---

### 2.3 发送成功提示页面

**设计要求**:

```
┌─────────────────────────────────┐
│                                 │
│           ✉️ 📧                  │
│                                 │
│       邮件已发送                 │
│                                 │
│  我们已向 u***@example.com      │
│  发送了密码重置链接，请查收邮件。 │
│                                 │
│  ⏰ 链接有效期为 1 小时          │
│                                 │
│  ┌─────────────────────────────┐│
│  │       返回登录              ││
│  └─────────────────────────────┘│
│                                 │
│     没收到邮件？重新发送（60s）  │
│                                 │
└─────────────────────────────────┘
```

**说明**:
- 邮箱地址部分脱敏显示（保护用户隐私）
- 提供「重新发送」链接，带 60 秒倒计时

---

### 2.4 密码重置页面

**路由**: `/reset-password?token={token}`

**页面结构**:

```
┌─────────────────────────────────┐
│         设置新密码              │
├─────────────────────────────────┤
│                                 │
│  新密码                         │
│  ┌─────────────────────────────┐│
│  │ ••••••••               👁️  ││
│  └─────────────────────────────┘│
│  密码强度: ████░░░░ 中等        │
│                                 │
│  确认密码                        │
│  ┌─────────────────────────────┐│
│  │ ••••••••               👁️  ││
│  └─────────────────────────────┘│
│  ✓ 密码一致                     │
│                                 │
│  ┌─────────────────────────────┐│
│  │        确认重置              ││
│  └─────────────────────────────┘│
│                                 │
└─────────────────────────────────┘
```

**密码强度校验规则**:

| 强度 | 条件 | 颜色 |
|------|------|------|
| 弱 | 仅满足长度要求（8位以上） | 红色 |
| 中等 | 包含字母 + 数字 | 橙色 |
| 强 | 包含大小写字母 + 数字 + 特殊字符 | 绿色 |

**交互说明**:
- 👁️ 图标：点击切换密码明文/密文显示
- 实时显示密码强度进度条
- 两次密码输入不一致时显示错误提示
- 提交时进行最终校验

---

### 2.5 重置成功页面

```
┌─────────────────────────────────┐
│                                 │
│            ✓                    │
│                                 │
│       密码重置成功！             │
│                                 │
│  您的密码已成功重置，            │
│  请使用新密码登录。              │
│                                 │
│  ┌─────────────────────────────┐│
│  │        立即登录              ││
│  └─────────────────────────────┘│
│                                 │
│       3 秒后自动跳转登录页...    │
│                                 │
└─────────────────────────────────┘
```

**说明**:
- 显示成功图标和提示文案
- 3 秒倒计时后自动跳转登录页
- 提供「立即登录」按钮手动跳转

---

### 2.6 链接失效/错误页面

```
┌─────────────────────────────────┐
│                                 │
│            ⚠️                   │
│                                 │
│       链接已失效                 │
│                                 │
│  该密码重置链接已过期或无效，     │
│  请重新申请。                    │
│                                 │
│  ┌─────────────────────────────┐│
│  │       重新找回密码           ││
│  └─────────────────────────────┘│
│                                 │
│          返回登录               │
│                                 │
└─────────────────────────────────┘
```

---

## 3. 交互流程图

```
┌─────────┐    ┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│  登录页  │───▶│  输入邮箱    │───▶│  发送验证    │───▶│  查收邮件    │
└─────────┘    └─────────────┘    └─────────────┘    └─────────────┘
     │              │                   │                   │
     │              │                   │                   │
     │              ▼                   ▼                   ▼
     │         格式校验            发送成功/失败        点击重置链接
     │                                                      │
     │                                                      ▼
     │                                              ┌─────────────┐
     │                                              │  设置新密码  │
     │                                              └─────────────┘
     │                                                      │
     │                                                      ▼
     │                                              ┌─────────────┐
     ◀──────────────────────────────────────────────│  重置成功    │
                                                    └─────────────┘
```

---

## 4. 邮件模板设计

### 4.1 密码重置链接邮件

**邮件主题**: `【SecCortex】密码重置请求`

**邮件正文**:

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

尊敬的用户，您好！

我们收到了您的密码重置请求。请点击下方链接重置您的密码：

        [重置密码] (按钮样式)

或复制以下链接到浏览器打开：
{重置链接}

⏰ 链接有效期：本链接将在 1小时 后失效，请尽快完成操作。

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

⚠️ 安全提示：
• 如果这不是您本人的操作，请忽略此邮件
• 请勿将此链接分享给他人
• SecCortex 工作人员不会向您索要密码

如有任何问题，请联系技术支持。

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

SecCortex 云脑安全智能体平台
此邮件由系统自动发送，请勿直接回复

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

### 4.2 密码重置成功通知邮件

**邮件主题**: `【SecCortex】密码已成功重置`

**邮件正文**:

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

尊敬的用户，您好！

您的 SecCortex 账户密码已于 {重置时间} 成功重置。

📋 操作信息：
┌─────────────────────────────────┐
│ 操作时间：{重置时间}            │
│ 操作 IP ：{IP地址}              │
│ 操作设备：{设备信息}            │
└─────────────────────────────────┘

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

⚠️ 安全提示：
如果这不是您本人的操作，您的账户可能存在安全风险，请立即：
1. 再次重置密码
2. 联系技术支持：{支持邮箱}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

SecCortex 云脑安全智能体平台
此邮件由系统自动发送，请勿直接回复

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

## 5. 安全设计要求

| 要求项 | 说明 |
|--------|------|
| 重置链接有效期 | 30分钟 - 1小时 |
| 请求频率限制 | 同一邮箱 60 秒内只能请求一次 |
| 链接使用次数 | 一次性有效，使用后立即失效 |
| 密码强度要求 | 至少 8 位，包含字母和数字 |
| 通知机制 | 密码重置成功后发送邮件通知 |

---

## 6. 验收标准

- [ ] 登录页面可见「忘记密码」入口链接
- [ ] 邮箱输入页面支持格式校验
- [ ] 发送成功后显示确认页面
- [ ] 密码重置页面支持强度校验
- [ ] 两次密码一致性校验
- [ ] 重置成功后自动跳转登录页
- [ ] 链接过期显示失效提示页
- [ ] 60秒请求频率限制生效
- [ ] 邮件模板内容正确发送

---

## 7. 设计资源

### 相关文件

| 文件 | 路径 |
|------|------|
| 认证页面样式 | `frontend/css/auth.css` |
| 登录页面 | `frontend/portal/pages/login.html` |
| 注册页面 | `frontend/portal/pages/register.html` |

### 需要新增的文件

| 文件 | 路径 |
|------|------|
| 忘记密码页面 | `frontend/portal/pages/forgot-password.html` |
| 重置密码页面 | `frontend/portal/pages/reset-password.html` |
| 密码找回样式 | `frontend/portal/css/password-recovery.css` |
| 密码找回逻辑 | `frontend/portal/js/password-recovery.js` |

---

*文档版本: v1.0*  
*最后更新: 2025-12-23*

